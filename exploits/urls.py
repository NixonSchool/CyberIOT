from django.urls import path
from . import views

app_name = 'exploits'

urlpatterns = [
    path('', views.vulnerability_list, name='vulnerability_list'),
    path('report/', views.report_vulnerability, name='report_vulnerability'),
    path('dashboard/', views.dashboard, name='dashboard'),
    path('dashboard/<int:review_id>/update_review_status/', views.update_review_status, name='update_review_status'),
    path('my_vulnerabilities/', views.user_vulnerabilities, name='user_vulnerabilities'),
    path('search/', views.search_vulnerabilities, name='search_vulnerabilities'),
    path('export/', views.export_vulnerabilities, name='export_vulnerabilities'),  # export all vulnerabilities
    path('<slug:slug>/', views.vulnerability_detail, name='vulnerability_detail'),
    path('<slug:slug>/delete/', views.delete_vulnerability, name='delete_vulnerability'),
    path('<slug:slug>/update_status/', views.update_vulnerability_status, name='update_vulnerability_status'),
    path('<slug:slug>/export/', views.export_vulnerabilities, name='vulnerability_export'),  # export a single vulnerability
    path('api/vulnerabilities/', views.api_vulnerabilities, name='api_vulnerabilities'),

]


handler404 = 'exploits.views.handler404'
handler500 = 'exploits.views.handler500'
